# Database Fix Instructions

## Problem
The application is throwing this error:
```
ORA-00904: "DELETED": invalid identifier
```

This means the `HR.ITEM` table exists but doesn't have the `DELETED` column that's required for soft delete functionality.

## Solution

You have **two options** to fix this:

---

### Option 1: Add DELETED Column to Existing Table (Recommended)

If you have existing data in your `HR.ITEM` table and want to keep it:

1. **Open SQL Developer or SQL*Plus** and connect to your Oracle database as HR user

2. **Run the migration script**:
   ```sql
   -- Add DELETED column
   ALTER TABLE HR.ITEM ADD DELETED NUMBER DEFAULT 0;
   
   -- Update existing records
   UPDATE HR.ITEM SET DELETED = 0 WHERE DELETED IS NULL;
   
   -- Commit
   COMMIT;
   ```

   **OR** run the file: `src/add_deleted_column.sql`

3. **Verify** the column was added:
   ```sql
   SELECT * FROM HR.ITEM;
   ```

---

### Option 2: Recreate Table (If you don't have important data)

If you don't have important data and can recreate the table:

1. **Open SQL Developer or SQL*Plus** and connect as HR user

2. **Run the updated database_setup.sql**:
   ```sql
   DROP TABLE HR.ITEM;
   CREATE TABLE HR.ITEM (
       id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
       name VARCHAR2(100),
       price NUMBER,
       total_number NUMBER,
       deleted NUMBER DEFAULT 0,
       PRIMARY KEY (id)
   );
   ```

   **OR** run the file: `src/database_setup.sql`

---

## Quick Fix (Copy and Paste)

**If you have existing data**, run this in SQL Developer/SQL*Plus:

```sql
ALTER TABLE HR.ITEM ADD DELETED NUMBER DEFAULT 0;
UPDATE HR.ITEM SET DELETED = 0 WHERE DELETED IS NULL;
COMMIT;
```

**If you don't have existing data**, run this:

```sql
DROP TABLE HR.ITEM;
CREATE TABLE HR.ITEM (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    name VARCHAR2(100),
    price NUMBER,
    total_number NUMBER,
    deleted NUMBER DEFAULT 0,
    PRIMARY KEY (id)
);
```

---

## After Running the Fix

1. **Restart your Tomcat server** (if needed)
2. **Test the application**:
   - Go to: `http://localhost:8080/Servlet-JSP/ItemController?action=show-items`
   - The error should be gone

---

## Verification

After adding the column, verify it exists:

```sql
-- Check table structure
DESC HR.ITEM;

-- Should show DELETED column
SELECT column_name, data_type, data_default 
FROM user_tab_columns 
WHERE table_name = 'ITEM';
```

You should see `DELETED` in the column list.

